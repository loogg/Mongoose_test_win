# Mongoose Wizard Project

This project is generated by Mongoose Wizard, https://mongoose.ws/wizard/
Mongoose Wizard is a visual Web dashboard builder for embedded devices.

## Build and flash

**Step 1. Download generated project to your workstation**

Click on the "Generate" button to download the project to your workstation

**Step 2. Build and run the project**

- If your target IDE is CubeIDE, then start Cube IDE (use Cube 1.16.0 or later), then:
  1. Choose File / Import
  2. Choose "Existing Projects into Workspace", click Next,
  3. Click on "Directory", choose dir with generated files, click Finish
- If your target IDE is MCUXpresso, follow instructions for Cube IDE above
- If your target IDE is VSCode (with STM32CUBE for VS Code extension), then:
  1. Launch **Visual Studio Code**
  2. Under the **File** section, select **Open folder** to open the directory where the
  project is located in.
  3. To build, click the **Build** button on the bottom sidebar.
  4. To flash, go to **Run and Debug (Ctrl+Shift+D)**, click **Run and Debug** and, when
  prompted, select the desired **STM32Cube** debugger (e.g. **STM32Cube: STLink GDB Server**)
- If your target IDE is VSCode (with NXP MCUXpresso for VS Code extension), then:
  1. Make sure the **ARM GNU Toolchain** and **Debug Probes** are installed
   (you can install them using the **MCUXpresso Installer**).
   Also ensure **CMake** and **Ninja** are installed and that their install locations
   are added to your system **PATH** variable.
  2. Launch **Visual Studio Code**.
  3. Open the **MCUXpresso** view from the Activity Bar.
  4. Click **Import Project → Browse**, and select the **root folder** of this project.
  5. In the **Import Project** dialog:
   - Choose the **ARM GNU Toolchain** path and the **SDK** path
     (the extension should auto-detect both).
   - Note: make sure the SDK corresponding to your target device is installed.
     To install an SDK, open the **Quickstart** panel in the MCUXpresso extension,
     select **Import Repository → Remote Archive**, and choose the appropriate package.
  6. Click **Import**. The project will appear in the MCUXpresso workspace tree.
- If your target IDE is Arduino, open `wizard.ino` in the Arduino IDE
- If your target IDE is other - follow your IDE's guide

## Injecting Mongoose to an existing firmware

In order to move this functionality to some existing firmware code, perform
the following steps:

1. Generate new wizard project with your target architecture
2. Copy / link the `mongoose/` folder from wizard project to your existing project
3. Edit the `mongoose/mongoose_config.h` if necessary
4. Add `mongoose/` to your include paths, and `mongoose/*.c` to source files. This depends on your IDE
5. On ARMs with built-in Ethernet, disable CPU cache
6. Add the following to your main C file:

```c
#include "mongoose_glue.h"
// #include "mongoose_hal.h"  // A helper micro-HAL for your platform

...

// Uncomment if required
//
// uint64_t mg_millis(void) {
//   return HAL_GetTick();
// }
//
// bool mg_random(void *buf, size_t len) {
//   for (size_t n = 0; n < len; n += 4) {
//     uint32_t r = hal_rng_read();
//     memcpy((char *) buf + n, &r, n + 4 > len ? len - n : 4);
//   }
//   return true;
// }
//
// int _write(int fd, char *buf, unsigned int len) {
//   if (fd == 1) hal_uart_write_buf(HAL_DEBUG_UART, buf, (size_t) len);
//   return len;
// }


  // Add to the end of main(). Uncomment what needs to be initialized.
  //
  // hal_clock_init();
  // hal_uart_init(HAL_DEBUG_UART, 115200);
  // hal_rng_init();
  // hal_leds_init();
  // hal_ethernet_init();
  //
  // You may need to include a specific section for Ethernet RAM
  // Example for the STM32H723:
  // - add in mongoose_config.h redefine the macro MG_ETH_RAM:
  // #define MG_ETH_RAM __attribute__((section(".eth_ram")))
  // - edit your linker script to include a .eth_ram section:
  //
  // MEMORY
  // {
  //  RAM_D2(rwx): ORIGIN = 0x30000000, LENGTH = 32K
  //  ...
  // }
  //
  //  .eth_ram : { *(.eth_ram .eth_ram*) } > RAM_D2 AT > ROM
  mongoose_init();

  // Event loop. mongoose_poll() does not block.
  // Add it into your existing barememetal superloop,
  // or start as a separate RTOS task with minimum of 8k stack
  for (;;) {
    mongoose_poll();
  }

```

## Guides and Tutorials

- [Video Guides](https://www.youtube.com/@mongoose-networking-library/videos)
- [Ethernet hardware](https://mongoose.ws/documentation/tutorials/hardware/)
- [Firmware OTA updates](https://mongoose.ws/documentation/tutorials/firmware-update/)
- [Mongoose User Guide](https://mongoose.ws/documentation/)
